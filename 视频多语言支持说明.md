# 视频多语言支持功能说明

## 功能概述

实现了视频资源根据当前语言环境自动切换播放源的功能，支持Bilibili嵌入式播放器和MP4直链两种视频格式。

## 修改内容

### 1. 数据类型扩展 (`src/data/types.ts`)

在 `Video` 接口中新增以下可选字段：

- `bilibiliUrlEn?: string` - 英文版Bilibili链接（可选）
- `mp4Url?: string` - 中文版MP4视频链接（可选）
- `mp4UrlEn?: string` - 英文版MP4视频链接（可选）

```typescript
export interface Video {
  id: number;
  titleKey: string;
  descriptionKey: string;
  bilibiliUrl: string;          // 默认（中文）Bilibili链接
  bilibiliUrlEn?: string;        // 英文版Bilibili链接
  mp4Url?: string;              // 中文版MP4视频链接
  mp4UrlEn?: string;            // 英文版MP4视频链接
  thumbnailPath: string;
  gradientFrom: string;
  gradientTo: string;
}
```

### 2. 视频数据配置 (`src/data/content.ts`)

为第二个视频（城市SDG发展报告）添加英文版MP4链接：

```typescript
{
  id: 2,
  titleKey: 'reports.cityVideo.title',
  descriptionKey: 'reports.cityVideo.description',
  bilibiliUrl: '//player.bilibili.com/player.html?isOutside=true&aid=112750793592788&bvid=BV1eeaFeaErX&cid=500001608959623&p=1',
  mp4UrlEn: 'https://data.mofimo.cn/2024sdg_en.mp4', // 英文版使用MP4视频
  thumbnailPath: '/images/videos/city-sdg-video-thumbnail.jpg',
  gradientFrom: 'from-[#00d4ff]/20',
  gradientTo: 'to-[#00ff88]/20'
}
```

### 3. 视频播放逻辑 (`src/components/sections/ReportsSection.tsx`)

#### 3.1 更新 `handleVideoPlay` 函数

修改函数签名，接收完整的 video 对象，并根据当前语言选择合适的视频源：

```typescript
const handleVideoPlay = (video: typeof videos[0]) => {
  // 根据当前语言选择合适的视频源
  let videoUrl = video.bilibiliUrl;
  
  if (locale === 'en') {
    // 英文环境：优先使用英文MP4，其次英文Bilibili，最后默认Bilibili
    if (video.mp4UrlEn) {
      videoUrl = video.mp4UrlEn;
    } else if (video.bilibiliUrlEn) {
      videoUrl = video.bilibiliUrlEn;
    }
  } else {
    // 中文环境：优先使用中文MP4，其次默认Bilibili
    if (video.mp4Url) {
      videoUrl = video.mp4Url;
    }
  }
  
  setCurrentVideoUrl(videoUrl);
  setCurrentVideoTitle(tGlobal(video.titleKey));
  setIsVideoModalOpen(true);
};
```

#### 3.2 更新视频播放器渲染逻辑

在Modal中根据视频URL类型（Bilibili或MP4）选择不同的播放器：

```typescript
<div className="w-full bg-black rounded-b-xl" style={{ aspectRatio: '16/9' }}>
  {currentVideoUrl.endsWith('.mp4') ? (
    // MP4视频使用video标签
    <video
      src={currentVideoUrl}
      className="w-full h-full border-0 rounded-b-xl"
      controls
      autoPlay
      title={currentVideoTitle}
    >
      您的浏览器不支持视频播放。
    </video>
  ) : (
    // Bilibili等嵌入式播放器使用iframe
    <iframe
      src={currentVideoUrl}
      className="w-full h-full border-0 rounded-b-xl"
      allowFullScreen
      title={currentVideoTitle}
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
    />
  )}
</div>
```

## 视频源选择优先级

### 中文环境 (locale === 'zh')
1. `mp4Url` - 中文版MP4视频
2. `bilibiliUrl` - 默认Bilibili链接

### 英文环境 (locale === 'en')
1. `mp4UrlEn` - 英文版MP4视频 ⭐
2. `bilibiliUrlEn` - 英文版Bilibili链接
3. `bilibiliUrl` - 默认Bilibili链接

## 使用示例

### 场景1：中英文使用不同Bilibili视频

```typescript
{
  id: 1,
  titleKey: 'reports.exampleVideo.title',
  descriptionKey: 'reports.exampleVideo.description',
  bilibiliUrl: '//player.bilibili.com/...chinese_video',
  bilibiliUrlEn: '//player.bilibili.com/...english_video',
  thumbnailPath: '/images/videos/example-thumbnail.jpg',
  gradientFrom: 'from-[#00ff88]/20',
  gradientTo: 'to-[#00d4ff]/20'
}
```

### 场景2：英文使用MP4，中文使用Bilibili

```typescript
{
  id: 2,
  titleKey: 'reports.cityVideo.title',
  descriptionKey: 'reports.cityVideo.description',
  bilibiliUrl: '//player.bilibili.com/...chinese_bilibili',
  mp4UrlEn: 'https://example.com/video_en.mp4',
  thumbnailPath: '/images/videos/city-sdg-video-thumbnail.jpg',
  gradientFrom: 'from-[#00d4ff]/20',
  gradientTo: 'to-[#00ff88]/20'
}
```

### 场景3：中英文都使用MP4

```typescript
{
  id: 3,
  titleKey: 'reports.anotherVideo.title',
  descriptionKey: 'reports.anotherVideo.description',
  bilibiliUrl: '//player.bilibili.com/...fallback_video',
  mp4Url: 'https://example.com/video_zh.mp4',
  mp4UrlEn: 'https://example.com/video_en.mp4',
  thumbnailPath: '/images/videos/another-thumbnail.jpg',
  gradientFrom: 'from-[#00ff88]/20',
  gradientTo: 'to-[#00d4ff]/20'
}
```

## 当前配置效果

- **中文环境 (zh)**：第二个视频（城市SDG发展报告）播放Bilibili嵌入视频
- **英文环境 (en)**：第二个视频（城市SDG发展报告）播放MP4视频 `https://data.mofimo.cn/2024sdg_en.mp4`

## 播放器特性

### Bilibili播放器 (iframe)
- 支持弹幕
- Bilibili平台控制
- 需要网络连接到Bilibili

### MP4播放器 (video标签)
- 原生HTML5播放器
- 支持自动播放
- 完整的视频控制（播放、暂停、音量、全屏等）
- 直接从CDN加载，性能更好

## 技术实现要点

1. **类型安全**：通过TypeScript接口确保数据结构正确
2. **向后兼容**：所有新增字段都是可选的，不影响现有视频配置
3. **智能选择**：根据语言环境和可用资源自动选择最合适的播放源
4. **灵活配置**：支持Bilibili和MP4两种格式的任意组合
5. **用户体验**：根据视频格式自动选择最合适的播放器类型

